<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <title>Contact - FrameAcademy App</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <style>
        body{
            margin:0;
            font-family:'Poppins', sans-serif;
            background: linear-gradient(135deg, #ffffff, #000000);
            min-height:100vh;
            color:#111;
        }

        .contact-hero{
            padding: 140px 20px 60px;
            text-align:center;
            color:#fff;
        }

        .contact-title{
            font-size: clamp(36px, 6vw, 80px);
            font-weight: 800;
            letter-spacing: 3px;
            text-transform: uppercase;
            color: transparent;
            -webkit-text-stroke: 2px #ffffff;
            text-shadow: 0 10px 30px rgba(0,0,0,0.6);
        }

        .contact-subtitle{
            max-width: 900px;
            margin: 20px auto 0;
            font-size: 18px;
            line-height: 1.7;
            color: #eaeaea;
        }

        .contact-wrap{
            width: min(1100px, 92%);
            margin: 30px auto 80px;
            background: #ffffff;
            border-radius: 36px;
            padding: 40px;
            box-shadow: 0 25px 60px rgba(0,0,0,0.45);
        }

        .contact-grid{
            display:grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 24px;
        }

        .contact-card{
            background: #f8f8f8;
            border-radius: 24px;
            padding: 24px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
        }

        .contact-card h3{
            margin: 0 0 10px;
            font-size: 20px;
            color: #a100ff;
        }

        .contact-card p{
            margin: 0;
            line-height: 1.6;
            color: #333;
        }

        .contact-detail{
            margin-top: 10px;
            font-weight: 600;
            color: #111;
            word-break: break-word;
        }

        .contact-long{
            margin-top: 30px;
            font-size: 18px;
            line-height: 1.8;
            color: #333;
        }
    </style>
</head>
<body>

<!-- ðŸ” HEADER -->
<header>
    <div class="logo">
        <img src="https://img.freepik.com/free-vector/bird-colorful-gradient-design-vector_343694-2506.jpg" width="40" alt="FrameAcademy logo">
        <span>FrameAcademy App</span>
    </div>
    <nav>
        <a href="index.html">HOME</a>
        <a href="aboutus.html">ABOUT</a>
        <a href="gallery.html">GALLERY</a>
        <a href="social.html">SOCIAL MEDIA</a>
        <a href="contact.html" class="active">CONTACT</a>
    </nav>
    <div class="user-chip">
        <img id="headerAvatar" src="https://cdn-icons-png.flaticon.com/512/149/149071.png" alt="User avatar">
        <span id="headerName">USER</span>
    </div>
    <div class="menu">â˜°</div>
</header>

<!-- SIDE MENU -->
<div class="side-menu" id="sideMenu">
    <div class="side-header">
        <div class="user-avatar">
            <img src="https://cdn-icons-png.flaticon.com/512/149/149071.png" alt="User avatar">
        </div>
        <h3>USER_NAME</h3>
        <div class="side-email" id="sideEmail">user@email.com</div>
        <p>City â€¢ Age</p>
    </div>

    <div class="side-links">
        <button id="editProfileBtn" class="profile-btn">Edit Profile</button>
        <a href="index.html">HOME</a>
        <a href="aboutus.html">ABOUT</a>
        <a href="gallery.html">GALLERY</a>
        <a href="social.html">SOCIAL MEDIA</a>
        <a href="contact.html">CONTACT</a>
    </div>

    <div class="auth-buttons">
        <a id="loginBtn" href="kiru.html" class="auth-btn">Log in</a>
        <a id="registerBtn" href="tirkelu.html" class="auth-btn">Register</a>
        <button id="logoutBtn" class="auth-btn" onclick="logout()" style="display:none;">Log Out</button>
    </div>
</div>

<div class="side-overlay" id="sideOverlay"></div>

<section class="contact-hero">
    <h1 class="contact-title">CONTACT</h1>
    <p class="contact-subtitle">
        You can reach us at any time. This section contains full information about phone numbers,
        email addresses, working hours, location, and ways to get in touch.
    </p>
</section>

<section class="contact-wrap">
    <div class="contact-grid">
        <div class="contact-card">
            <h3>Phone</h3>
            <p>Call us directly to get quick consultation.</p>
            <div class="contact-detail">+7 (707) 123-45-67</div>
            <div class="contact-detail">+7 (701) 987-65-43</div>
        </div>

        <div class="contact-card">
            <h3>Email</h3>
            <p>Send your questions and suggestions by email.</p>
            <div class="contact-detail">info@frameacademy.kz</div>
            <div class="contact-detail">support@frameacademy.kz</div>
        </div>

        <div class="contact-card">
            <h3>Working Hours</h3>
            <p>Monday â€“ Friday: 09:00 â€“ 20:00</p>
            <p>Saturday: 10:00 â€“ 16:00</p>
            <p>Sunday: Closed</p>
        </div>

        <div class="contact-card">
            <h3>Address</h3>
            <p>Kazakhstan, Almaty, Abylai Khan Ave 123</p>
            <p>Office: 4th floor, Room 405</p>
        </div>
    </div>

    <div class="contact-long">
        Every message matters to us. If you have questions about programs, courses,
        pricing, or partnerships, you can call us or send an email. You can also
        leave feedback or suggestions. We aim to reply during business days as
        quickly as possible. For urgent issues, calling us directly is the fastest option.
    </div>
</section>

<div class="profile-modal" id="profileModal">
    <div class="modal-card">
        <div class="modal-title">Edit Profile</div>
        <div class="modal-grid">
            <div class="modal-field">
                <label for="profileName">Name</label>
                <input id="profileName" type="text" placeholder="Your name">
            </div>
            <div class="modal-field">
                <label for="profileCity">City</label>
                <input id="profileCity" type="text" placeholder="Your city">
            </div>
            <div class="modal-field">
                <label for="profileAge">Age</label>
                <input id="profileAge" type="number" min="1" max="120" placeholder="Your age">
            </div>
            <div class="modal-field">
                <label for="profileAvatarFile">Avatar file</label>
                <input id="profileAvatarFile" type="file" accept="image/*">
            </div>
        </div>
        <div class="modal-row">
            <img id="profileAvatarPreview" class="avatar-preview" src="https://cdn-icons-png.flaticon.com/512/149/149071.png" alt="Avatar preview">
            <div>Preview</div>
        </div>
        <div class="modal-actions">
            <button class="btn-secondary" id="profileCancel">Cancel</button>
            <button class="btn-primary" id="profileSave">Save</button>
        </div>
    </div>
</div>

<script>
    const menuBtn = document.querySelector('.menu');
    const sideMenu = document.getElementById('sideMenu');
    const overlay = document.getElementById('sideOverlay');

    menuBtn.addEventListener('click', () => {
        sideMenu.classList.add('active');
        overlay.classList.add('active');
    });

    overlay.addEventListener('click', () => {
        sideMenu.classList.remove('active');
        overlay.classList.remove('active');
    });
</script>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
  import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";
  import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";
  import { initializeAppCheck, ReCaptchaEnterpriseProvider } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app-check.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCr6pAI4GCkwnlZEBq_1M1dWeWpGtrn1a4",
    authDomain: "frameacademy-bb04a.firebaseapp.com",
    projectId: "frameacademy-bb04a",
    storageBucket: "frameacademy-bb04a.firebasestorage.app",
    messagingSenderId: "1018686855581",
    appId: "1:1018686855581:web:e4f5d6f42ee6d43ba8b774",
    measurementId: "G-SDMK2NPGBZ"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  initializeAppCheck(app, {
    provider: new ReCaptchaEnterpriseProvider("6Leh0WYsAAAAAHISvriKLV94fJuWFuJRgIaXbGUb"),
    isTokenAutoRefreshEnabled: true
  });

  const loginBtn = document.getElementById('loginBtn');
  const registerBtn = document.getElementById('registerBtn');
  const logoutBtn = document.getElementById('logoutBtn');
  const userNameH3 = document.querySelector('.side-header h3');
  const userMetaP = document.querySelector('.side-header p');
  const sideEmail = document.getElementById('sideEmail');
  const sideAvatar = document.querySelector('.side-header img');
  const headerName = document.getElementById('headerName');
  const headerAvatar = document.getElementById('headerAvatar');
  const editProfileBtn = document.getElementById('editProfileBtn');
  const profileModal = document.getElementById('profileModal');
  const profileName = document.getElementById('profileName');
  const profileCity = document.getElementById('profileCity');
  const profileAge = document.getElementById('profileAge');
  const profileAvatarFile = document.getElementById('profileAvatarFile');
  const profileAvatarPreview = document.getElementById('profileAvatarPreview');
  const profileSave = document.getElementById('profileSave');
  const profileCancel = document.getElementById('profileCancel');
  let pendingAvatarData = "";
  let toastTimer;

  function showToast(message) {
    let toast = document.getElementById('toast');
    if (!toast) {
      toast = document.createElement('div');
      toast.id = 'toast';
      toast.className = 'toast';
      document.body.appendChild(toast);
    }
    toast.innerHTML = '';
    const title = document.createElement('div');
    title.className = 'toast-title';
    title.textContent = 'Push notification';
    const msg = document.createElement('div');
    msg.className = 'toast-msg';
    msg.textContent = message;
    toast.appendChild(title);
    toast.appendChild(msg);
    toast.classList.add('show');
    clearTimeout(toastTimer);
    toastTimer = setTimeout(() => {
      toast.classList.remove('show');
    }, 2400);
  }

  function getProfile() {
    const raw = localStorage.getItem('profile');
    if (!raw) return { name: "", city: "", age: "", avatarData: "" };
    try { return JSON.parse(raw); } catch { return { name: "", city: "", age: "", avatarData: "" }; }
  }

  function setProfile(profile) {
    localStorage.setItem('profile', JSON.stringify(profile));
  }

  async function fetchProfile(user) {
    if (!user) return getProfile();
    try {
      const snap = await getDoc(doc(db, "users", user.uid));
      if (snap.exists()) {
        const data = snap.data();
        const profile = {
          name: data.name || "",
          city: data.city || "",
          age: data.age || "",
          avatarData: data.avatarData || ""
        };
        setProfile(profile);
        return profile;
      }
    } catch (err) {
      console.warn("Profile load failed:", err);
    }
    return getProfile();
  }

  async function applyProfile(user) {
    const profile = await fetchProfile(user);
    const displayName = profile.name || (user && (user.displayName || user.email || user.phoneNumber)) || "USER";
    const city = profile.city || "City";
    const age = profile.age || "Age";
    const avatar = profile.avatarData || "https://cdn-icons-png.flaticon.com/512/149/149071.png";
    const email = (user && user.email) ? user.email : "";

    if (userNameH3) userNameH3.textContent = displayName;
    if (userMetaP) userMetaP.textContent = `${city} â€¢ ${age}`;
    if (sideEmail) sideEmail.textContent = email || "";
    if (sideAvatar) sideAvatar.src = avatar;
    if (headerName) headerName.textContent = displayName;
    if (headerAvatar) headerAvatar.src = avatar;
    if (profileAvatarPreview) profileAvatarPreview.src = avatar;
  }

  window.logout = async () => {
    try {
      await signOut(auth);
      localStorage.removeItem('profile');
      await applyProfile(null);
      showToast("Signed out");
      document.getElementById('sideMenu').classList.remove('active');
      document.getElementById('sideOverlay').classList.remove('active');
    } catch (err) {
      showToast(err.message);
    }
  };

  onAuthStateChanged(auth, async (user) => {
    if (user) {
      await applyProfile(user);
      loginBtn.style.display = 'none';
      registerBtn.style.display = 'none';
      logoutBtn.style.display = 'block';
    } else {
      await applyProfile(null);
      loginBtn.style.display = 'inline-block';
      registerBtn.style.display = 'inline-block';
      logoutBtn.style.display = 'none';
    }
  });

  if (editProfileBtn && profileModal) {
    editProfileBtn.addEventListener('click', () => {
      const current = getProfile();
      profileName.value = current.name || "";
      profileCity.value = current.city || "";
      profileAge.value = current.age || "";
      pendingAvatarData = current.avatarData || "";
      profileAvatarPreview.src = pendingAvatarData || "https://cdn-icons-png.flaticon.com/512/149/149071.png";
      profileAvatarFile.value = "";
      profileModal.classList.add('active');
    });
  }

  if (profileCancel && profileModal) {
    profileCancel.addEventListener('click', () => {
      profileModal.classList.remove('active');
    });
  }

  if (profileAvatarFile) {
    profileAvatarFile.addEventListener('change', (e) => {
      const file = e.target.files && e.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = () => {
        pendingAvatarData = String(reader.result || "");
        profileAvatarPreview.src = pendingAvatarData;
      };
      reader.readAsDataURL(file);
    });
  }

  if (profileSave && profileModal) {
    profileSave.addEventListener('click', async () => {
      const updated = {
        name: profileName.value.trim(),
        city: profileCity.value.trim(),
        age: profileAge.value.trim(),
        avatarData: pendingAvatarData
      };
      setProfile(updated);
      if (auth.currentUser) {
        try {
          await setDoc(doc(db, "users", auth.currentUser.uid), updated, { merge: true });
        } catch (err) {
          console.warn("Profile save failed:", err);
        }
      }
      await applyProfile(auth.currentUser || null);
      profileModal.classList.remove('active');
    });
  }
</script>

</body>
</html>
